# 中期综合练习

1. 算术运算表达式
1. 算术运算表达式解析器
1. 实用技巧及工具

		
## 算术运算表达式

`Arithmetic operation expression`

	
### 三种算术运算表达式

- 前缀表达式（prefix expression）：运算符（operator）位于操作数（operand）之前（波兰式）
   - 简单形式：`+ 3 5`
   - 复杂形式：`+ 3 * 5 8 `
- 中缀表达式（infix expression）：运算符位于操作数之间
   - 简单形式：`3 + 5`
   - 复杂形式：`3 + 5 * 8`
- 后缀表达式（postfix expression）：运算符位于操作数之后（逆波兰式）
   - 简单形式：`3 5 +`
   - 复杂形式：`5 8 * 3 +`
- 以上复杂形式的表达式求值（evalute）过程，本质上相当于函数调用：`add(3, mul(5, 8))`。
- 前缀表达式和后缀表达式的解析和求值，只需要栈即可完成。
- 中缀表达式可转换为前缀表达式或后缀表达式再行处理；亦可解析为求值树再行求值。

	
#### 前缀表达式的求值

- 求值过程：
  1. 创建一个空的操作数栈。
  1. 从右至左扫描表达式。
  1. 若遇到数值时，将数值压入操作数栈；若遇到运算符，则从操作数栈弹出两个数值，用当前运算符对它们做相应的计算（先弹出的数值作为运算符左值，后弹出的数值作为运算符右值），然后将结果压入操作数栈。
  1. 重复上述过程直到表达式全部处理完成；栈顶数值即为该表达式的求值结果。
- 例如:`- × + 3 4 5 6`
  1. 从右至左扫描，依次将 `6`、`5`、`4`、`3` 压入操作数栈。
  1. 其后是 `+` 运算符，从操作数栈中依次弹出 `3` 和 `4`，计算 `3+4`，得 `7`，再将 `7` 压入操作数栈。
  1. 其后是 `×` 运算符，从操作数栈中依次弹出 `7` 和 `5`，计算 `7×5`，得 `35`，将 `35` 压入操作数栈。
  1. 其后是 `-` 运算符，从操作数栈中依次弹出 `35` 和 `6`，计算 `35-6`，得 `29`，将 `29` 压入操作数栈。
  1. 表达式扫描完成，取出栈顶数值 `29`，得出表达式的求值结果为 `29`。

	
#### 后缀表达式的求值

- 求值过程：
  1. 创建一个空的操作数栈。
  1. 从左到右扫描表达式。
  1. 若遇到数值时，将数值压入操作数栈；若遇到运算符，则从操作数栈弹出两个数值，用当前运算符对它们做相应的计算（先弹出的数值作为运算符右值，后弹出的数值作为运算符左值），然后将结果压入操作数栈。
  1. 重复上述过程直到表达式全部处理完成；栈顶数值即为该表达式的求值结果。
- 例如:`3 4 + 5 × 6 -`
  1. 将数值 `3`、`4` 压入栈。
  1. 其后是 `+` 运算符，从操作数栈中依次弹出 `3` 和 `4`，计算 `4+3`，得 `7`，再将 `7` 压入操作数栈。
  1. 其后是数值 `5`，压入操作数栈。
  1. 其后是 `×` 运算符，从操作数栈中依次弹出 `5` 和 `7`，计算 `7×5`，得 `35`，将 `35` 压入操作数栈。
  1. 其后是数值 `6`，压入操作数栈。
  1. 其后是 `-` 运算符，从操作数栈中依次弹出 `6` 和 `35`，计算 `35-6`，得 `29`，将 `29` 压入操作数栈。
  1. 表达式扫描完成，取出栈顶数值 `29`，得出表达式的求值结果为 `29`。

	
#### 中缀表达式转换为前缀表达式

1. 初始化两个栈：运算符栈 `operators` 和结果的栈 `result`。
1. 从右至左扫描中缀表达式。
1. 遇到操作数时，将其压入 `result`。
1. 遇到运算符时，比较其与 `operators` 栈顶运算符的优先级。
   1. 如果 `operators` 为空，或栈顶运算符为右括号 `)`，则直接将此运算符入栈；
   1. 否则，若该运算符的优先级比栈顶运算符`高或相等`，将该运算符压入 `operators`；
   1. 否则，将 `operators` 栈顶的运算符弹出并压入到 `result` 中，并转到步骤 4.1。
1. 遇到括号时，
   1. 如果是右括号 `)`，则直接压入 `operators`。
   1. 如果是左括号 `(`，则依次弹出 `operators` 栈顶的运算符，并压入 `result`，直到遇到右括号为止，此时将这一对括号丢弃。
1. 重复步骤2，直到表达式的最左边。
1. 将 `operators` 中剩余的运算符依次弹出并压入 `result`。
1. 依次弹出 `result` 中的元素并输出，结果即为中缀表达式对应的前缀表达式。

	
#### 中缀表达式转换为后缀表达式

1. 初始化两个栈：运算符栈 `operators` 和结果栈 `result`。
1. 从左至右扫描中缀表达式。
1. 遇到操作数时，将其压 `result`。
1. 遇到运算符时，比较其与 `operators` 栈顶运算符的优先级：
   1. 如果 `operators` 为空，或栈顶运算符为左括号 `(`，则直接将此运算符入栈；
   1. 否则，若该运算符的优先级比栈顶运算符`高`，将该运算符压入 `operators`；
   1. 否则，将 `operators` 栈顶的运算符弹出并压入到 `result` 中，并转到步骤 4.1。
1. 遇到括号时，
   1. 如果是左括号 `(`，则直接压入 `s1`；
   1. 如果是右括号 `)`，则依次弹出 `operators` 栈顶的运算符，并压入 `result`，直到遇到左括号为止，此时将这一对括号丢弃。
1. 重复步骤2，直到表达式的最右边；
1. 将 `operators` 中剩余的运算符依次弹出并压入 `result`；
1. 依次弹出 `result` 中的元素并输出，其结果的`逆序`即为中缀表达式对应的后缀表达式。

	
#### 将中缀表达式解析为求值树

		
## 算术运算表达式解析器

`Arithmetic operation expression parser`

	
1) 操作数的转换

	
### 算术运算表达式的求值

		
## 实用技巧及工具

`C++ skills and utilities`

