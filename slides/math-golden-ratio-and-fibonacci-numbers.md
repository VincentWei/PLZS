# 黄金分割比和斐波那契数列

- 黄金分割比
- 斐波那契数列和黄金分割比的关系
- 斐波那契数列的神奇性质
- 斐波那契数列的通项公式
- 斐波那契数系
- 卢卡斯数

		
## 黄金分割比

希腊艺术家菲狄亚斯的雕刻

《几何原本》中有关正五边形“中外比”的描述  

<img style="height:30%;width:auto;" src="assets/math-pentagon.svg" />

	
正五边形中的中外比满足如下条件：  

<img style="height:30%;width:auto;" src="assets/math-golden-ratio.svg" />

对应代数式：

`$$
\begin{align}
    \frac{x}{1} & = \frac{1}{x-1} \\
    x^2 - x - 1 & = 0
\end{align}
$$`

	

求解后得：

`$$
\begin{align}
  \phi       & = \frac{1+\sqrt{5}}{2} \\
             & \approx 1.6180339887   \\
  \hat{\phi} & = \frac{1-\sqrt{5}}{2}  \\
             & \approx -0.6180339887
\end{align}
$$`

也满足：

`$$
  \phi = 1 + \frac{1}{\phi}
$$`

	
- 尺规作图画正五边形

		
## 斐波那契数列和黄金分割比的关系

- 斐波那契（Fibonacci）数列由莱昂纳多・斐波纳契于 1202 年引入。

`$$
1 \ 1 \  2 \  3 \  5 \  8 \  13 \  21 \  34 \  55 \  89 \  144 \  233
$$`

- 植物界无处不在的斐波那契数
   - 万寿菊有 `13`、`21` 或者 `34` 片花瓣
   - 向日葵有 `55`、`89` 或者 `144` 片花瓣
   - 黄金角度：`$ 137.5^{\circ} $` 及[斐波纳契螺旋](https://616pic.com/sucai/pvjehdkp1.html)
- 自然现象中的斐波纳契数

	
- 观察斐波那契数列相邻两个数的比值

```console
0 / 1:	0
1 / 0:	inf
1 / 1:	1
1 / 1:	1
1 / 2:	0.5
2 / 1:	2
2 / 3:	0.66666666666666662966
3 / 2:	1.5
3 / 5:	0.5999999999999999778
5 / 3:	1.6666666666666667407
5 / 8:	0.625
8 / 5:	1.6000000000000000888
8 / 13:	0.61538461538461541878
13 / 8:	1.625
13 / 21:	0.61904761904761906877
21 / 13:	1.6153846153846154188
21 / 34:	0.61764705882352943789
34 / 21:	1.6190476190476190688
34 / 55:	0.61818181818181816567
55 / 34:	1.6176470588235294379
55 / 89:	0.61797752808988759554
89 / 55:	1.6181818181818183877
89 / 144:	0.61805555555555558023
144 / 89:	1.6179775280898875955
144 / 233:	0.61802575107296142676
233 / 144:	1.6180555555555553582
233 / 377:	0.61803713527851456
377 / 233:	1.6180257510729614268
377 / 610:	0.61803278688524587725
610 / 377:	1.61803713527851456
610 / 987:	0.61803444782168182048
987 / 610:	1.6180327868852459883
987 / 1597:	0.61803381340012519818
1597 / 987:	1.6180344478216819315
1597 / 2584:	0.61803405572755421016
2584 / 1597:	1.6180338134001250872
2584 / 4181:	0.61803396316670655697
4181 / 2584:	1.6180340557275540991
4181 / 6765:	0.61803399852180340712
6765 / 4181:	1.6180339631667064459
6765 / 10946:	0.61803398501735795634
10946 / 6765:	1.6180339985218032961
10946 / 17711:	0.61803399017559712547
17711 / 10946:	1.6180339850173577343
17711 / 28657:	0.61803398820532506885
28657 / 17711:	1.6180339901755971255
28657 / 46368:	0.61803398895790195855
46368 / 28657:	1.6180339882053251799
46368 / 75025:	0.61803398867044323506
75025 / 46368:	1.6180339889579018475
75025 / 121393:	0.61803398878024273788
121393 / 75025:	1.618033988670443124
121393 / 196418:	0.6180339887383029529
196418 / 121393:	1.6180339887802428489
196418 / 317811:	0.61803398875432258297
317811 / 196418:	1.6180339887383028419
317811 / 514229:	0.61803398874820358877
514229 / 317811:	1.618033988754322694
514229 / 832040:	0.61803398875054083028
832040 / 514229:	1.6180339887482035888
832040 / 1346269:	0.61803398874964809995
1346269 / 832040:	1.6180339887505408303
1346269 / 2178309:	0.61803398874998904944
2178309 / 1346269:	1.618033988749648211
2178309 / 3524578:	0.61803398874985882028
3524578 / 2178309:	1.6180339887499892715
3524578 / 5702887:	0.61803398874990855827
5702887 / 3524578:	1.6180339887498589313
5702887 / 9227465:	0.61803398874988957346
9227465 / 5702887:	1.6180339887499086693
9227465 / 14930352:	0.61803398874989690093
14930352 / 9227465:	1.6180339887498895735
14930352 / 24157817:	0.61803398874989412537
24157817 / 14930352:	1.6180339887498966789
24157817 / 39088169:	0.61803398874989512457
39088169 / 24157817:	1.6180339887498940143
39088169 / 63245986:	0.6180339887498947915
63245986 / 39088169:	1.6180339887498949025
63245986 / 102334155:	0.61803398874989490253
102334155 / 63245986:	1.6180339887498946805
102334155 / 165580141:	0.6180339887498947915
165580141 / 102334155:	1.6180339887498949025
165580141 / 267914296:	0.61803398874989490253
267914296 / 165580141:	1.6180339887498946805
267914296 / 433494437:	0.6180339887498947915
433494437 / 267914296:	1.6180339887498949025
433494437 / 701408733:	0.61803398874989490253
701408733 / 433494437:	1.6180339887498946805
701408733 / 1134903170:	0.61803398874989490253
1134903170 / 701408733:	1.6180339887498946805
1134903170 / 1836311903:	0.61803398874989490253
1836311903 / 1134903170:	1.6180339887498946805
1836311903 / 2971215073:	0.61803398874989490253
2971215073 / 1836311903:	1.6180339887498946805
2971215073 / 4807526976:	0.61803398874989490253
4807526976 / 2971215073:	1.6180339887498946805
4807526976 / 7778742049:	0.61803398874989490253
7778742049 / 4807526976:	1.6180339887498946805
7778742049 / 12586269025:	0.61803398874989490253
12586269025 / 7778742049:	1.6180339887498946805
12586269025 / 20365011074:	0.61803398874989490253
20365011074 / 12586269025:	1.6180339887498946805
20365011074 / 32951280099:	0.61803398874989490253
32951280099 / 20365011074:	1.6180339887498946805
32951280099 / 53316291173:	0.61803398874989490253
53316291173 / 32951280099:	1.6180339887498946805
53316291173 / 86267571272:	0.61803398874989490253
86267571272 / 53316291173:	1.6180339887498946805
86267571272 / 139583862445:	0.61803398874989490253
139583862445 / 86267571272:	1.6180339887498946805
139583862445 / 225851433717:	0.61803398874989490253
225851433717 / 139583862445:	1.6180339887498946805
225851433717 / 365435296162:	0.61803398874989490253
365435296162 / 225851433717:	1.6180339887498946805
365435296162 / 591286729879:	0.61803398874989490253
591286729879 / 365435296162:	1.6180339887498946805
591286729879 / 956722026041:	0.61803398874989490253
956722026041 / 591286729879:	1.6180339887498946805
956722026041 / 1548008755920:	0.61803398874989490253
1548008755920 / 956722026041:	1.6180339887498946805
1548008755920 / 2504730781961:	0.61803398874989490253
2504730781961 / 1548008755920:	1.6180339887498946805
2504730781961 / 4052739537881:	0.61803398874989490253
4052739537881 / 2504730781961:	1.6180339887498946805
4052739537881 / 6557470319842:	0.61803398874989490253
6557470319842 / 4052739537881:	1.6180339887498946805
6557470319842 / 10610209857723:	0.61803398874989490253
10610209857723 / 6557470319842:	1.6180339887498946805
10610209857723 / 17167680177565:	0.61803398874989490253
17167680177565 / 10610209857723:	1.6180339887498946805
17167680177565 / 27777890035288:	0.61803398874989490253
27777890035288 / 17167680177565:	1.6180339887498946805
27777890035288 / 44945570212853:	0.61803398874989490253
44945570212853 / 27777890035288:	1.6180339887498946805
44945570212853 / 72723460248141:	0.61803398874989490253
72723460248141 / 44945570212853:	1.6180339887498946805
72723460248141 / 117669030460994:	0.61803398874989490253
117669030460994 / 72723460248141:	1.6180339887498946805
117669030460994 / 190392490709135:	0.61803398874989490253
190392490709135 / 117669030460994:	1.6180339887498946805
190392490709135 / 308061521170129:	0.61803398874989490253
308061521170129 / 190392490709135:	1.6180339887498946805
308061521170129 / 498454011879264:	0.61803398874989490253
498454011879264 / 308061521170129:	1.6180339887498946805
498454011879264 / 806515533049393:	0.61803398874989490253
806515533049393 / 498454011879264:	1.6180339887498946805
806515533049393 / 1304969544928657:	0.61803398874989490253
1304969544928657 / 806515533049393:	1.6180339887498946805
1304969544928657 / 2111485077978050:	0.61803398874989490253
2111485077978050 / 1304969544928657:	1.6180339887498946805
2111485077978050 / 3416454622906707:	0.61803398874989490253
3416454622906707 / 2111485077978050:	1.6180339887498946805
3416454622906707 / 5527939700884757:	0.61803398874989490253
5527939700884757 / 3416454622906707:	1.6180339887498946805
5527939700884757 / 8944394323791464:	0.61803398874989490253
8944394323791464 / 5527939700884757:	1.6180339887498946805
8944394323791464 / 14472334024676221:	0.61803398874989490253
14472334024676221 / 8944394323791464:	1.6180339887498946805
14472334024676221 / 23416728348467685:	0.6180339887498947915
23416728348467685 / 14472334024676221:	1.6180339887498949025
23416728348467685 / 37889062373143906:	0.61803398874989490253
37889062373143906 / 23416728348467685:	1.6180339887498946805
37889062373143906 / 61305790721611591:	0.6180339887498947915
61305790721611591 / 37889062373143906:	1.6180339887498949025
61305790721611591 / 99194853094755497:	0.6180339887498947915
99194853094755497 / 61305790721611591:	1.6180339887498949025
99194853094755497 / 160500643816367088:	0.6180339887498947915
160500643816367088 / 99194853094755497:	1.6180339887498949025
160500643816367088 / 259695496911122585:	0.61803398874989490253
259695496911122585 / 160500643816367088:	1.6180339887498946805
259695496911122585 / 420196140727489673:	0.61803398874989490253
420196140727489673 / 259695496911122585:	1.6180339887498946805
420196140727489673 / 679891637638612258:	0.61803398874989490253
679891637638612258 / 420196140727489673:	1.6180339887498946805
679891637638612258 / 1100087778366101931:	0.6180339887498947915
1100087778366101931 / 679891637638612258:	1.6180339887498949025
1100087778366101931 / 1779979416004714189:	0.6180339887498947915
1779979416004714189 / 1100087778366101931:	1.6180339887498949025
1779979416004714189 / 2880067194370816120:	0.61803398874989490253
2880067194370816120 / 1779979416004714189:	1.6180339887498946805
2880067194370816120 / 4660046610375530309:	0.6180339887498947915
4660046610375530309 / 2880067194370816120:	1.6180339887498949025
4660046610375530309 / 7540113804746346429:	0.61803398874989490253
7540113804746346429 / 4660046610375530309:	1.6180339887498946805
7540113804746346429 / 12200160415121876738:	0.6180339887498947915
12200160415121876738 / 7540113804746346429:	1.6180339887498949025
```

	
- 斐波那契数列的定义

`$$
\large{
\begin{align}
  F_0 & = 0 \\
  F_1 & = 1 \\
  F_n & = F_{n-2} + F_{n-1}, \ (n \gt 1)
\end{align}
}
$$`

		
## 斐波那契数列的神奇性质

卡西尼恒等式

`$$
\large{
    F_{n+1}F_{n-1} -F^2_n = (-1)^n
}
$$`

- 此等式由意大利天文学家卡西尼于 1680 年发现，如 `$ 13 \times 5 - 8^2 = 1 $`。

	
### 一个跟斐波那契数列有关的几何障眼法

<img style="height:auto;width:100%;" src="assets/math-fibonacci-numbers-1.svg" />

	
### 卡西尼恒等式的证明

	
### 斐波那契数列的推广

`$$
\large{
\begin{align}
    F_{-1} & = F_1 - F_0 \\
    F_{-2} & = F_0 - F_{-1}
\end{align}
}
$$`

	
推广公式：

`$$
\large{
    F_{-n} = (-1)^{n-1}F_n
}
$$`

	
### 斐波那契数列的其他性质

`$$
\begin{align}
  \cdots                            \\
  F_{n-4}  & = -3F_{n+1} + 5F_{n}   \\
  F_{n-3}  & = 2F_{n+1} - 3F_{n}    \\
  F_{n-2}  & = -F_{n+1} + 2F_{n}    \\
  F_{n-1}  & = F_{n+1} - F_{n}      \\
  F_{n+2}  & = F_{n+1} + F_{n}      \\
  F_{n+3}  & = 2F_{n+1} + F_{n}     \\
  F_{n+4}  & = 3F_{n+1} + 2F_{n}    \\
  F_{n+5}  & = 5F_{n+1} + 3F_{n}    \\
  \cdots                            \\
\end{align}
$$`

也就是说，

`$$
\large{
    F_{n+k} = F_kF_{n+1} + F_{k-1}F_{n} \qquad (\forall \ k, n \in \mathbb{Z})
}
$$`

	
- 倍增法计算斐波那契数

`$$
\large{
\begin{align}
  F_{2n}   & = F_n(2F_{n+1} - F_{n}) \\
  F_{2n+1} & = F^2_{n+1} + F^2_n
\end{align}
}
$$`

	
### 斐波那契数列的其他性质

在下式中，

`$$
  F_{n+k}  = F_kF_{n+1} + F_{k-1}F_{n}
$$`


若取 `k = n`，或 `k = 2n`，则有：

`$$
\begin{align}
  F_{2n}  & = F_nF_{n+1} + F_{n-1}F_{n} \\
  F_{3n}  & = F_{2n}F_{n+1} + F_{2n-1}F_{n}
\end{align}
$$`

用归纳法很快可以得到结论：对所有的整数 `$ k $` 和 `$ n $`，`$ F_{kn} $` 都是 `$ F_{n} $` 的倍数。

类似地，有关最大公约数的性质：

`$$
\gcd(F_m,\ F_n) = F_{\gcd(m,\ n)}
$$`

		
## 斐波那契数列的通项公式

- 通项公式（Binet's Formula）

`$$
\begin{align}
F_{n} & = \frac{\left( \frac{1 + \sqrt{5}}{2} \right)^n - \left( \frac{1 - \sqrt{5}}{2} \right)^n}{\sqrt{5}} \\
      & = \frac{\phi^n - {\hat{\phi}}^n}{\sqrt{5}} \\
      & = \frac{\phi^n - (-\phi)^{-n}}{\sqrt{5}}
\end{align}
$$`

- 或，

`$$
\begin{align}
F_{n} & = \left[ \frac{\left( \frac{1 + \sqrt{5}}{2} \right)^n}{\sqrt{5}} \right] = \left[ \frac{\phi^n}{\sqrt{5}} \right]
\end{align}
$$`

	
### 斐波那契数列的通项公式的推导

1) 考虑 `$ F(z) = F_0 + F_1 z + F_2 z^2 + F_3 z^3 + ... $`

	
2) 构造分式，使之满足 `$ \frac{A}{1-\alpha z} + \frac{B}{1-\beta z} = \frac{z}{1 - z - z^2} $`

	
3) 根据 `$ (1-\alpha z)(1-\beta z) = 1 - z - z^2 $` 求解常数 `$ \alpha, \ \beta $`

	
4) 根据 `$ A - A \beta z + B - B \alpha z = z $` 求解常数 `$ A, \ B $`

	
5) 得出最终的通项公式（此推导由丹尼尔 伯努利于 1728 年给出）

	
### 为什么斐波那契数列相邻两个数的比值接近黄金分割比

将卡西尼恒等式：

`$$
    F_{n+1}F_{n-1} -F^2_n = (-1)^n
$$`


变换为另一种形式：

`$$
    \frac{F_{n+1}}{F_n} - \frac{F_n}{F_{n-1}} = \frac{(-1)^n}{F_{n-1}F_{n}}
$$`

事实上，

`$$
    F_{n+1} = \phi F_n + \hat{\phi}^n
$$`

		
## 斐波那契数系

- Zeckendorf 定理

引入记法

`$$
j \gg k \Leftrightarrow j \ge k + 2
$$`

则每个正整数都有唯一的表示形式：

`$$
  n = F_{k_1} + F_{k_2} + \cdots + F_{k_r}, \quad k_1 \gg k_2 \gg \cdots k_r \gg 0
$$`

比如，

`$$
\begin{align}
  1,000,000 &= 832,040 &&+ 121,393 &&+ 46,368 &&+ 144    &&+ 55 \\
            &= F_{30}  &&+ F_{26}  &&+ F_{24} &&+ F_{12} &&+ F_{10}
\end{align}
$$`

	
- 我们可以将任意非负整数 `$ n $` 用 `$ 0 $` 和 `$ 1 $` 的序列表示：

`$$
n = (b_{m}b_{m-1} \cdots b_2)_F \Leftrightarrow n = \sum_{k=2}^{m} b_kF_k, \qquad b_k = 0 \ or \ 1
$$`

		
## 卢卡斯数

卢卡斯（Lucas）数列的定义如下：

`$$
\begin{align}
    L_0 & = 2 \\
    L_1 & = 1 \\
    L_n & = L_{n-1} + L_{n-2}
\end{align}
$$`

该数列的前几项如下：

`$$
2, 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 199, \dots
$$`

卢卡斯数列的通项公式：

`$$
\large{
    L_n = \left(\frac{1 + \sqrt{5}}{2}\right)^n + \left(\frac{1 - \sqrt{5}}{2}\right)^n
}
$$`

而且有：

`$$
\large{
    {L_n}^2-5{F_n}^2=-4
}
$$`

